{
  "Name": "SQLInjectionAdvanced",
  "Priority": 100,
  "Statement": {
    "OrStatement": {
      "Statements": [
        {
          "RegexMatchStatement": {
            "RegexString": "(union|select|insert|update|delete|drop|create|alter|exec|execute).*\\s*(from|into|where|table|database|column)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "HTML_ENTITY_DECODE"},
              {"Priority": 2, "Type": "LOWERCASE"},
              {"Priority": 3, "Type": "COMPRESS_WHITE_SPACE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(--|#|/\\*|\\*/|;--|;#|'--|'#)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "URL_DECODE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(=|<|>|!=|<=|>=)\\s*\\d+\\s*(or|and|\\|\\||&&)\\s*(=|<|>|!=|<=|>=)\\s*\\d+",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "COMPRESS_WHITE_SPACE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "('|\")(\\s)*(or|and)(\\s)*('|\")?(=|<|>|!=|like)('|\")?",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(0x[0-9a-f]+|char\\s*\\(|ascii\\s*\\(|hex\\s*\\(|unhex\\s*\\()",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(information_schema|mysql\\.|sys\\.|pg_catalog|sysobjects|syscolumns)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(@@version|@@datadir|user\\(\\)|database\\(\\)|version\\(\\))",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(extractvalue|updatexml|load_file|into\\s+outfile|into\\s+dumpfile)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "pg_sleep|waitfor\\s+delay|benchmark\\s*\\(|sleep\\s*\\(|randomblob\\s*\\(",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(/\\*!|/\\*\\*|--\\+|#\\s)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"}
            ]
          }
        }
      ]
    }
  },
  "Action": {"Block": {}},
  "VisibilityConfig": {
    "SampledRequestsEnabled": true,
    "CloudWatchMetricsEnabled": true,
    "MetricName": "SQLInjectionAdvanced"
  }
}
