{
  "Name": "XSSAdvanced",
  "Priority": 105,
  "Statement": {
    "OrStatement": {
      "Statements": [
        {
          "RegexMatchStatement": {
            "RegexString": "<\\s*svg[^>]*>.*<\\s*/\\s*svg\\s*>|<\\s*svg[^>]*(onload|onerror|onanimation)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "HTML_ENTITY_DECODE"},
              {"Priority": 2, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "<\\s*img[^>]*(src|onerror|onload)\\s*=",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "HTML_ENTITY_DECODE"},
              {"Priority": 2, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "<\\s*scr<script>ipt|</scr</script>ipt>|<\\s*scr\\s+ipt",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "HTML_ENTITY_DECODE"},
              {"Priority": 2, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "&#[x0-9]+;|\\\\u[0-9a-f]{4}|\\\\x[0-9a-f]{2}",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "(alert|prompt|confirm)\\s*\\(|window\\.(location|open)|document\\.(cookie|write|domain)",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "vbscript:|livescript:|mocha:|charset\\s*=|onerror\\s*=",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "LOWERCASE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "\\{\\{|\\{%|\\$\\{|\\<%|%>",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"}
            ]
          }
        },
        {
          "RegexMatchStatement": {
            "RegexString": "<\\s*(details|marquee|video|audio)[^>]*(on\\w+)\\s*=",
            "FieldToMatch": {"AllQueryArguments": {}},
            "TextTransformations": [
              {"Priority": 0, "Type": "URL_DECODE"},
              {"Priority": 1, "Type": "HTML_ENTITY_DECODE"},
              {"Priority": 2, "Type": "LOWERCASE"}
            ]
          }
        }
      ]
    }
  },
  "Action": {"Block": {}},
  "VisibilityConfig": {
    "SampledRequestsEnabled": true,
    "CloudWatchMetricsEnabled": true,
    "MetricName": "XSSAdvanced"
  }
}
